# Vulnerability Reference for Security Scanner Testing

**Purpose:** This document provides a comprehensive reference of Docker images and packages with known, documented CVEs for testing security scanning tools (Trivy, Snyk, Grype).

**⚠️ WARNING:** These images and packages are intentionally vulnerable and should ONLY be used for testing purposes. Never deploy these in production environments.

**Last Updated:** January 2026  
**Maintenance Schedule:** Quarterly review (April, July, October, January)

---

## Table of Contents

- [Base Image Vulnerability Reference](#base-image-vulnerability-reference)
- [Node.js Vulnerable Packages](#nodejs-vulnerable-packages)
- [Python Vulnerable Packages](#python-vulnerable-packages)
- [Java Vulnerable Dependencies](#java-vulnerable-dependencies)
- [Dockerfile Examples](#dockerfile-examples)
- [Expected Scanner Output](#expected-scanner-output)
- [Maintenance Guide](#maintenance-guide)
- [CVE Database Links](#cve-database-links)

---

## Base Image Vulnerability Reference

### Node.js Images

| Image Tag | OS Base | Expected Vulnerabilities | Primary CVEs | Notes |
|-----------|---------|-------------------------|--------------|-------|
| `node:14.15.0` | Debian Buster | Critical: 8-12, High: 25-35, Medium: 40-60 | CVE-2021-44531 (Node.js), CVE-2021-3711 (OpenSSL), CVE-2021-23840 (OpenSSL) | Widely used, reliable detection, Node.js 14.x has multiple CVEs |
| `node:12.18.3` | Debian Buster | Critical: 10-15, High: 30-45, Medium: 50-70 | CVE-2020-8172, CVE-2020-8174, CVE-2020-11080 | Older Node.js version with HTTP request smuggling vulnerabilities |
| `node:10.23.0` | Debian Buster | Critical: 15-20, High: 40-55, Medium: 60-85 | CVE-2020-8277 (DoS), CVE-2021-22883, CVE-2021-22884 | Node.js 10.x EOL, many unpatched vulnerabilities |
| `node:16.14.0-alpine3.15` | Alpine 3.15 | Critical: 2-5, High: 8-15, Medium: 15-25 | CVE-2022-0778 (OpenSSL), CVE-2022-21824 (Node.js) | Alpine images have fewer CVEs but still vulnerable |

**Why These Versions:**
- Node.js 14.15.0: Released Nov 2020, has documented CVEs in Node.js core and OpenSSL
- Node.js 12.18.3: Released July 2020, contains HTTP/2 vulnerabilities
- Node.js 10.23.0: End-of-Life version with numerous unpatched vulnerabilities
- Alpine variant: Tests scanner behavior with minimal base images

### Python Images

| Image Tag | OS Base | Expected Vulnerabilities | Primary CVEs | Notes |
|-----------|---------|-------------------------|--------------|-------|
| `python:3.7.9` | Debian Buster | Critical: 5-10, High: 20-30, Medium: 35-50 | CVE-2021-3177, CVE-2021-23336, CVE-2020-26116 | Python 3.7.9 has multiple documented vulnerabilities |
| `python:3.6.12` | Debian Buster | Critical: 8-12, High: 25-40, Medium: 45-65 | CVE-2021-3177, CVE-2020-27619, CVE-2020-8492 | Python 3.6.x EOL, numerous vulnerabilities |
| `python:3.8.6` | Debian Buster | Critical: 3-7, High: 15-25, Medium: 25-40 | CVE-2021-3177, CVE-2020-27619 | Mid-range vulnerability count for testing |
| `python:3.9.0-alpine3.12` | Alpine 3.12 | Critical: 2-4, High: 8-12, Medium: 12-20 | CVE-2021-3426, CVE-2020-27619 | Alpine variant with fewer system vulnerabilities |

**Why These Versions:**
- Python 3.7.9: Released Aug 2020, has pickle, urllib, and XML vulnerabilities
- Python 3.6.12: EOL version with unpatched security issues
- Python 3.8.6: Balance between recent and vulnerable
- Alpine variant: Tests minimal image scanning

### Java Images

| Image Tag | OS Base | Expected Vulnerabilities | Primary CVEs | Notes |
|-----------|---------|-------------------------|--------------|-------|
| `openjdk:11.0.12-jdk` | Oracle Linux 7 | Critical: 6-10, High: 20-30, Medium: 40-60 | CVE-2021-2163, CVE-2021-2341, CVE-2021-2369 | OpenJDK 11.0.12 has known serialization vulnerabilities |
| `openjdk:8u292-jdk` | Oracle Linux 7 | Critical: 10-15, High: 30-45, Medium: 50-75 | CVE-2021-2163, CVE-2021-2341, CVE-2020-14781 | Java 8 has many documented vulnerabilities |
| `eclipse-temurin:17.0.1_12-jdk` | Ubuntu 20.04 | Critical: 4-8, High: 15-25, Medium: 30-45 | CVE-2022-21248, CVE-2022-21283, CVE-2022-21291 | Java 17.0.1 has specific CVEs in libraries |
| `adoptopenjdk:11.0.10-jdk` | Ubuntu 18.04 | Critical: 7-12, High: 22-35, Medium: 45-65 | CVE-2021-2163, CVE-2020-14803, CVE-2020-14792 | AdoptOpenJDK variant for testing different distributions |

**Why These Versions:**
- OpenJDK 11.0.12: Released July 2021, has documented vulnerabilities in core libraries
- OpenJDK 8u292: Widely used, many known CVEs
- Eclipse Temurin 17.0.1: Tests newer Java versions
- AdoptOpenJDK: Tests alternative JDK distributions

---

## Node.js Vulnerable Packages

### Critical Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `lodash` | `4.17.19` | CVE-2020-8203 | Prototype pollution vulnerability | `4.17.21+` |
| `minimist` | `1.2.5` | CVE-2021-44906 | Prototype pollution in argument parsing | `1.2.6+` |
| `node-fetch` | `2.6.0` | CVE-2020-15168 | Size limit bypass leading to DoS | `2.6.1+` |
| `axios` | `0.21.0` | CVE-2020-28168 | SSRF vulnerability | `0.21.1+` |
| `express` | `4.16.4` | CVE-2022-24999 | Open redirect vulnerability | `4.17.3+` |

### High Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `moment` | `2.29.1` | CVE-2022-24785 | ReDoS in date parsing | `2.29.2+` |
| `validator` | `13.5.2` | CVE-2021-3765 | Open redirect vulnerability | `13.6.0+` |
| `socket.io-parser` | `3.3.1` | CVE-2020-36048 | Object injection vulnerability | `3.3.2+` |
| `ws` | `7.4.5` | CVE-2021-32640 | ReDoS vulnerability | `7.4.6+` |
| `ajv` | `6.12.2` | CVE-2020-15366 | Prototype pollution | `6.12.3+` |

### Medium Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `ini` | `1.3.5` | CVE-2020-7788 | Prototype pollution | `1.3.6+` |
| `yargs-parser` | `18.1.3` | CVE-2020-7608 | Prototype pollution | `18.1.4+` |
| `dot-prop` | `4.2.0` | CVE-2020-8116 | Prototype pollution | `4.2.1+` |
| `path-parse` | `1.0.6` | CVE-2021-23343 | ReDoS vulnerability | `1.0.7+` |
| `json-schema` | `0.2.3` | CVE-2021-3918 | Prototype pollution | `0.4.0+` |

---

## Python Vulnerable Packages

### Critical Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `django` | `2.2.0` | CVE-2021-33203, CVE-2021-33571 | SQL injection and directory traversal | `2.2.24+` |
| `flask` | `1.1.1` | CVE-2023-30861 | Cookie parsing vulnerability | `2.2.5+` |
| `pillow` | `8.1.0` | CVE-2021-25287, CVE-2021-25288 | Buffer overflow vulnerabilities | `8.1.1+` |
| `pyyaml` | `5.3.1` | CVE-2020-14343 | Arbitrary code execution | `5.4+` |
| `jinja2` | `2.11.2` | CVE-2020-28493 | ReDoS vulnerability | `2.11.3+` |

### High Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `requests` | `2.25.0` | CVE-2023-32681 | Proxy authentication header leak | `2.31.0+` |
| `urllib3` | `1.26.3` | CVE-2021-33503 | CRLF injection | `1.26.5+` |
| `cryptography` | `3.3.1` | CVE-2020-36242 | Bleichenbacher timing oracle attack | `3.3.2+` |
| `sqlalchemy` | `1.3.22` | CVE-2019-7164 | SQL injection | `1.3.23+` |
| `werkzeug` | `1.0.1` | CVE-2023-25577 | Resource exhaustion | `2.2.3+` |

### Medium Severity

| Package | Vulnerable Version | CVE(s) | Description | Patched Version |
|---------|-------------------|--------|-------------|----------------|
| `httplib2` | `0.18.1` | CVE-2021-21240 | CRLF injection | `0.19.0+` |
| `lxml` | `4.6.2` | CVE-2021-28957 | XSS vulnerability | `4.6.3+` |
| `bleach` | `3.2.1` | CVE-2021-23980 | Mutation XSS | `3.3.0+` |
| `notebook` | `6.1.5` | CVE-2020-26215 | Open redirect | `6.1.6+` |
| `mistune` | `0.8.4` | CVE-2022-34749 | ReDoS vulnerability | `2.0.1+` |

---

## Java Vulnerable Dependencies

### Critical Severity

| Artifact ID | Vulnerable Version | CVE(s) | Description | Patched Version |
|-------------|-------------------|--------|-------------|----------------|
| `log4j-core` | `2.14.1` | CVE-2021-44228 (Log4Shell) | Remote code execution | `2.17.1+` |
| `spring-core` | `5.2.0.RELEASE` | CVE-2022-22965 (Spring4Shell) | Remote code execution | `5.3.18+` |
| `jackson-databind` | `2.9.8` | CVE-2020-36518, CVE-2020-36179 | Deserialization vulnerabilities | `2.12.6.1+` |
| `commons-collections` | `3.2.1` | CVE-2015-6420 | Remote code execution via deserialization | `3.2.2+` |
| `struts2-core` | `2.5.20` | CVE-2021-31805 | OGNL injection | `2.5.29+` |

### High Severity

| Artifact ID | Vulnerable Version | CVE(s) | Description | Patched Version |
|-------------|-------------------|--------|-------------|----------------|
| `spring-web` | `5.2.0.RELEASE` | CVE-2021-22096 | Directory traversal | `5.2.20+` |
| `tomcat-embed-core` | `9.0.37` | CVE-2021-25122, CVE-2021-25329 | Request smuggling | `9.0.43+` |
| `commons-fileupload` | `1.3.3` | CVE-2016-1000031 | DoS vulnerability | `1.4+` |
| `httpclient` | `4.5.10` | CVE-2020-13956 | Incorrect handling of malformed authority | `4.5.13+` |
| `velocity-engine-core` | `2.2` | CVE-2020-13936 | Arbitrary code execution | `2.3+` |

### Medium Severity

| Artifact ID | Vulnerable Version | CVE(s) | Description | Patched Version |
|-------------|-------------------|--------|-------------|----------------|
| `commons-compress` | `1.20` | CVE-2021-35515, CVE-2021-35516 | Infinite loop vulnerabilities | `1.21+` |
| `commons-io` | `2.6` | CVE-2021-29425 | Path traversal | `2.7+` |
| `gson` | `2.8.6` | CVE-2022-25647 | Stack overflow | `2.8.9+` |
| `snakeyaml` | `1.27` | CVE-2022-25857 | DoS vulnerability | `1.31+` |
| `h2` | `1.4.199` | CVE-2022-23221 | Remote code execution | `2.0.206+` |

---

## Dockerfile Examples

### Example 1: Node.js Critical Vulnerabilities

```dockerfile
# Test Case: Node.js with multiple critical CVEs
# Expected: 8-12 CRITICAL, 25-35 HIGH, 40-60 MEDIUM
FROM node:14.15.0

WORKDIR /app

# Install vulnerable packages
COPY package.json .
RUN npm install

COPY . .

# Non-root user for security testing
RUN addgroup --system --gid 1001 nodejs && \
    adduser --system --uid 1001 nodejs
USER nodejs

EXPOSE 3000
CMD ["node", "index.js"]
```

**package.json:**
```json
{
  "name": "vulnerable-node-test",
  "version": "1.0.0",
  "dependencies": {
    "lodash": "4.17.19",
    "minimist": "1.2.5",
    "axios": "0.21.0",
    "express": "4.16.4",
    "moment": "2.29.1",
    "ws": "7.4.5"
  }
}
```

### Example 2: Python High Severity Vulnerabilities

```dockerfile
# Test Case: Python with Django and Pillow vulnerabilities
# Expected: 5-10 CRITICAL, 20-30 HIGH, 35-50 MEDIUM
FROM python:3.7.9

WORKDIR /app

# Install vulnerable packages
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

# Non-root user
RUN addgroup --system --gid 1001 appuser && \
    adduser --system --uid 1001 --gid 1001 appuser
USER appuser

EXPOSE 8000
CMD ["python", "app.py"]
```

**requirements.txt:**
```txt
Django==2.2.0
Flask==1.1.1
Pillow==8.1.0
PyYAML==5.3.1
Jinja2==2.11.2
requests==2.25.0
urllib3==1.26.3
cryptography==3.3.1
```

### Example 3: Java Log4Shell Vulnerability

```dockerfile
# Test Case: Java with Log4Shell and Spring vulnerabilities
# Expected: 6-10 CRITICAL, 20-30 HIGH, 40-60 MEDIUM
FROM openjdk:11.0.12-jdk

WORKDIR /app

# Copy Maven project with vulnerable dependencies
COPY pom.xml .
COPY mvnw .
COPY .mvn .mvn

RUN ./mvnw dependency:resolve

COPY src ./src
RUN ./mvnw package -DskipTests

# Non-root user
RUN groupadd -r appuser && useradd -r -g appuser appuser
USER appuser

EXPOSE 8080
CMD ["java", "-jar", "target/app.jar"]
```

**pom.xml (excerpt):**
```xml
<dependencies>
    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-core</artifactId>
        <version>2.14.1</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>5.2.0.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-databind</artifactId>
        <version>2.9.8</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tomcat.embed</groupId>
        <artifactId>tomcat-embed-core</artifactId>
        <version>9.0.37</version>
    </dependency>
</dependencies>
```

### Example 4: Alpine Minimal Vulnerabilities

```dockerfile
# Test Case: Alpine-based image with fewer vulnerabilities
# Expected: 2-5 CRITICAL, 8-15 HIGH, 15-25 MEDIUM
FROM node:16.14.0-alpine3.15

WORKDIR /app

# Install vulnerable packages
COPY package-alpine.json package.json
RUN npm install --production

COPY . .

# Non-root user
RUN addgroup -S appuser && adduser -S appuser -G appuser
USER appuser

EXPOSE 3000
CMD ["node", "server.js"]
```

**package-alpine.json:**
```json
{
  "name": "vulnerable-alpine-test",
  "version": "1.0.0",
  "dependencies": {
    "node-fetch": "2.6.0",
    "ajv": "6.12.2",
    "ini": "1.3.5"
  }
}
```

### Example 5: Multi-Stage Build with Vulnerabilities

```dockerfile
# Test Case: Multi-stage build still contains vulnerabilities
# Expected: 3-7 CRITICAL, 15-25 HIGH, 25-40 MEDIUM
FROM python:3.8.6 AS builder

WORKDIR /build
COPY requirements-vuln.txt requirements.txt
RUN pip install --user --no-cache-dir -r requirements.txt

# Runtime stage
FROM python:3.8.6-slim

WORKDIR /app
COPY --from=builder /root/.local /root/.local
COPY app.py .

ENV PATH=/root/.local/bin:$PATH

RUN groupadd -r appuser && useradd -r -g appuser appuser
USER appuser

EXPOSE 5000
CMD ["python", "app.py"]
```

**requirements-vuln.txt:**
```txt
Flask==1.1.1
SQLAlchemy==1.3.22
Werkzeug==1.0.1
httplib2==0.18.1
lxml==4.6.2
```

---

## Expected Scanner Output

### Trivy Output Format

```json
{
  "ArtifactName": "node:14.15.0",
  "Vulnerabilities": [
    {
      "VulnerabilityID": "CVE-2021-44531",
      "PkgName": "nodejs",
      "InstalledVersion": "14.15.0",
      "FixedVersion": "14.18.3, 16.13.2",
      "Severity": "CRITICAL",
      "Title": "Improper handling of URI Subject Alternative Names",
      "Description": "Accepting arbitrary Subject Alternative Name..."
    }
  ],
  "Summary": {
    "Critical": 10,
    "High": 28,
    "Medium": 52,
    "Low": 85,
    "Unknown": 3
  }
}
```

### Grype Output Format

```json
{
  "matches": [
    {
      "vulnerability": {
        "id": "CVE-2021-44531",
        "severity": "Critical"
      },
      "artifact": {
        "name": "nodejs",
        "version": "14.15.0"
      },
      "matchDetails": [
        {
          "type": "exact-direct-match"
        }
      ]
    }
  ],
  "source": {
    "type": "image",
    "target": {
      "userInput": "node:14.15.0"
    }
  }
}
```

### Snyk Output Format

```json
{
  "vulnerabilities": [
    {
      "id": "SNYK-DEBIAN10-NODEJS-1296047",
      "title": "Improper Certificate Validation",
      "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "severity": "critical",
      "packageName": "nodejs",
      "version": "14.15.0"
    }
  ],
  "summary": {
    "critical": 10,
    "high": 28,
    "medium": 52,
    "low": 85
  }
}
```

---

## Maintenance Guide

### Quarterly Review Checklist

**When:** April, July, October, January

1. **Verify CVE Detection:**
   - [ ] Run Trivy scan on all test images
   - [ ] Compare actual vs. expected vulnerability counts
   - [ ] Update expected ranges if databases changed

2. **Check Image Availability:**
   - [ ] Verify all base images still exist on Docker Hub
   - [ ] Check for deprecation notices
   - [ ] Identify alternative images if needed

3. **Update Package Versions:**
   - [ ] Check if vulnerable packages still install correctly
   - [ ] Verify CVEs are still in databases
   - [ ] Document any breaking changes

4. **Test Scanner Compatibility:**
   - [ ] Update scanner versions
   - [ ] Verify output format consistency
   - [ ] Update parsing logic if needed

5. **Review Test Reliability:**
   - [ ] Check test failure rates
   - [ ] Identify flaky tests
   - [ ] Adjust tolerance ranges if needed

### Handling Breaking Changes

**Scenario 1: Base Image Removed**
- **Action:** Use the next closest version or build custom base image
- **Example:** If `node:14.15.0` is removed, use `node:14.15.1` or `node:14.15`

**Scenario 2: CVE Count Drift**
- **Action:** Allow ±20% variance in expected counts
- **Example:** If expected 10 CRITICAL, allow 8-12 range

**Scenario 3: Package No Longer Available**
- **Action:** Use archived version or find equivalent vulnerable package
- **Example:** Mirror package to private registry for testing

**Scenario 4: Scanner Database Updates**
- **Action:** Baseline new counts quarterly
- **Example:** Re-run all scans and update expected values

### Automated Monitoring

**Setup Dependabot:**
```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "docker"
    directory: "/test/fixtures/vulnerable-images"
    schedule:
      interval: "monthly"
    open-pull-requests-limit: 0  # Don't auto-update vulnerable images
    labels:
      - "test-fixtures"
      - "manual-review"
```

**CI Check for Drift:**
```yaml
# .github/workflows/fixture-health.yml
name: Test Fixture Health Check
on:
  schedule:
    - cron: '0 0 1 */3 *'  # Quarterly
jobs:
  check-fixtures:
    runs-on: ubuntu-latest
    steps:
      - name: Scan test images
        run: |
          trivy image node:14.15.0 --format json > scan-results.json
          # Compare with expected counts
          # Alert if variance > 20%
```

### Version Pinning Strategy

**Base Images:** Always pin to exact version
```dockerfile
# ✅ Good
FROM node:14.15.0

# ❌ Bad (can change over time)
FROM node:14
FROM node:14-buster
```

**Application Dependencies:** Pin exact versions
```json
{
  "dependencies": {
    "lodash": "4.17.19"  // ✅ Exact version
  }
}
```

**Scanner Versions:** Pin major version, allow minor updates
```yaml
# CI configuration
- name: Install Trivy
  run: |
    # Pin to v0.x but allow patches
    wget https://github.com/aquasecurity/trivy/releases/download/v0.38.0/trivy_Linux-64bit.tar.gz
```

### Fallback Strategy

**Primary Image Unavailable:**
1. Check Docker Hub for nearest version
2. Build image from Dockerfile using archived packages
3. Use mirrored images from internal registry
4. Skip test temporarily with clear documentation

**CVE No Longer Detected:**
1. Verify CVE still exists in NVD database
2. Check scanner database version
3. Force scanner database update
4. Document as "scanner limitation" if persistent

**Test Consistently Fails:**
1. Check if expected ranges need adjustment
2. Verify scanner configuration
3. Review recent scanner updates
4. Isolate issue with minimal reproduction

---

## CVE Database Links

### Official CVE Databases

- **NIST NVD:** https://nvd.nist.gov/
- **MITRE CVE:** https://cve.mitre.org/
- **GitHub Advisory Database:** https://github.com/advisories
- **Snyk Vulnerability DB:** https://security.snyk.io/
- **OSV (Open Source Vulnerabilities):** https://osv.dev/

### Scanner-Specific Databases

- **Trivy DB:** https://github.com/aquasecurity/trivy-db
- **Grype DB:** https://github.com/anchore/grype-db
- **Snyk Intel Vulnerability DB:** https://snyk.io/vuln/

### Language-Specific Advisories

**Node.js:**
- npm Security Advisories: https://github.com/advisories?query=ecosystem%3Anpm
- Node.js Security Releases: https://nodejs.org/en/blog/vulnerability/

**Python:**
- PyPI Advisory Database: https://github.com/pypa/advisory-database
- Python Security Announcements: https://www.python.org/news/security/

**Java:**
- Maven Central Vulnerabilities: https://central.sonatype.org/
- Oracle Java Security Alerts: https://www.oracle.com/security-alerts/

### Verification Tools

**CVE Lookup:**
```bash
# Using Trivy
trivy image --list-all-pkgs node:14.15.0

# Using Grype
grype node:14.15.0 -o json

# Using Snyk
snyk container test node:14.15.0 --json
```

**Package Vulnerability Check:**
```bash
# Node.js
npm audit

# Python
pip-audit
safety check

# Java
mvn dependency-check:check
```

---

## Testing Strategy

### Test Levels

**Level 1: Basic Detection**
- Verify scanner detects CRITICAL vulnerabilities
- Expected: All scanners find Log4Shell, high-profile CVEs

**Level 2: Severity Accuracy**
- Verify severity classifications are consistent
- Expected: ±1 severity level variance acceptable

**Level 3: Count Accuracy**
- Verify vulnerability counts within tolerance
- Expected: ±20% variance from documented ranges

**Level 4: Remediation Guidance**
- Verify scanner provides fix recommendations
- Expected: Patched version suggestions present

### Acceptance Criteria

```typescript
interface ScanResults {
  critical: number;
  high: number;
  medium: number;
  low: number;
}

interface TestCase {
  image: string;
  expectedMin: ScanResults;
  expectedMax: ScanResults;
  mustDetectCVEs: string[];  // High-profile CVEs that must be found
}

// Example test case
const nodeVulnTest: TestCase = {
  image: 'node:14.15.0',
  expectedMin: { critical: 8, high: 25, medium: 40, low: 0 },
  expectedMax: { critical: 12, high: 35, medium: 60, low: 150 },
  mustDetectCVEs: ['CVE-2021-44531', 'CVE-2021-3711']
};
```

### Tolerance Ranges

- **Critical:** ±2 from expected
- **High:** ±5 from expected
- **Medium:** ±10 from expected
- **Low:** Not validated (too volatile)

### Update Thresholds

**When to Update Expected Counts:**
- Variance exceeds tolerance for 2+ consecutive quarters
- Scanner vendor updates methodology
- Base image receives security patches (creating new layer)

**When NOT to Update:**
- Single outlier scan result
- Minor fluctuations within tolerance
- Different scanner gives different count (expected)

---

## Appendix: Research Notes

### Selection Criteria

**Why These Specific Versions:**

1. **Temporal Balance:**
   - Not so old they're unavailable
   - Not so new they lack documented CVEs
   - Sweet spot: 2-4 years old

2. **CVE Density:**
   - Sufficient vulnerabilities for meaningful testing
   - Mix of critical, high, medium severities
   - Well-documented in scanner databases

3. **Reproducibility:**
   - Widely used versions (less likely to be removed)
   - Multiple independent CVE sources confirm
   - Scanner databases reliably detect

4. **Maintenance:**
   - Prefer versions just before major security releases
   - Avoid versions with package manager issues
   - Choose versions with stable dependency trees

### Alternative Test Images

**If Primary Images Unavailable:**

| Primary | Alternative | Notes |
|---------|-------------|-------|
| `node:14.15.0` | `node:14.17.0` | Similar CVE profile, more available |
| `python:3.7.9` | `python:3.7.10` | Slight CVE count variance |
| `openjdk:11.0.12-jdk` | `openjdk:11.0.11-jdk` | May have fewer CVEs |

### Future Considerations

**Trends to Monitor:**

1. **Scanner Convergence:**
   - Scanners becoming more consistent
   - May need tighter tolerance ranges

2. **CVE Database Growth:**
   - More historical CVEs being added
   - Expected counts may increase over time

3. **Image Removal:**
   - Docker Hub cleanup policies
   - May need to mirror critical test images

4. **Supply Chain Security:**
   - SBOM integration with scanners
   - Additional validation layers

---

## Quick Reference

### Command Cheat Sheet

```bash
# Scan with Trivy
trivy image node:14.15.0 --severity CRITICAL,HIGH,MEDIUM

# Scan with Grype
grype node:14.15.0 --fail-on high

# Scan with Snyk
snyk container test node:14.15.0 --severity-threshold=high

# Compare results
trivy image node:14.15.0 --format json > trivy.json
grype node:14.15.0 -o json > grype.json
diff <(jq '.Vulnerabilities | length' trivy.json) \
     <(jq '.matches | length' grype.json)

# Update scanner databases
trivy image --download-db-only
grype db update
```

### Dockerfile Build Commands

```bash
# Build Node.js test image
cd test/fixtures/vulnerable-images/nodejs
docker build -t vuln-test:node-14.15.0 .

# Build Python test image
cd test/fixtures/vulnerable-images/python
docker build -t vuln-test:python-3.7.9 .

# Build Java test image
cd test/fixtures/vulnerable-images/java
docker build -t vuln-test:java-11.0.12 .

# Scan locally built image
trivy image vuln-test:node-14.15.0
```

---

**Document Version:** 1.0  
**Authors:** Containerization Assist Team  
**License:** Testing purposes only - Do not use in production  
**Support:** For questions or updates, file an issue in the repository
